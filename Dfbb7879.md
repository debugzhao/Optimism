---
timezone: Asia/Shanghai
---

> 请在上边的 timezone 添加你的当地时区，这会有助于你的打卡状态的自动化更新，如果没有添加，默认为北京时间 UTC+8 时区
> 时区请参考以下列表，请移除 # 以后的内容

timezone: Pacific/Honolulu # 夏威夷-阿留申标准时间 (UTC-10)

timezone: America/Anchorage # 阿拉斯加标准时间 (UTC-9)

timezone: America/Los_Angeles # 太平洋标准时间 (UTC-8)

timezone: America/Denver # 山地标准时间 (UTC-7)

timezone: America/Chicago # 中部标准时间 (UTC-6)

timezone: America/New_York # 东部标准时间 (UTC-5)

timezone: America/Halifax # 大西洋标准时间 (UTC-4)

timezone: America/St_Johns # 纽芬兰标准时间 (UTC-3:30)

timezone: America/Sao_Paulo # 巴西利亚时间 (UTC-3)

timezone: Atlantic/Azores # 亚速尔群岛时间 (UTC-1)

timezone: Europe/London # 格林威治标准时间 (UTC+0)

timezone: Europe/Berlin # 中欧标准时间 (UTC+1)

timezone: Europe/Helsinki # 东欧标准时间 (UTC+2)

timezone: Europe/Moscow # 莫斯科标准时间 (UTC+3)

timezone: Asia/Dubai # 海湾标准时间 (UTC+4)

timezone: Asia/Kolkata # 印度标准时间 (UTC+5:30)

timezone: Asia/Dhaka # 孟加拉国标准时间 (UTC+6)

timezone: Asia/Bangkok # 中南半岛时间 (UTC+7)

timezone: Asia/Shanghai # 中国标准时间 (UTC+8)

timezone: Asia/Tokyo # 日本标准时间 (UTC+9)

timezone: Australia/Sydney # 澳大利亚东部标准时间 (UTC+10)

timezone: Pacific/Auckland # 新西兰标准时间 (UTC+12)

---

# {Dfbb7879}

1. 自我介绍
热爱区块链，想通过本次学习进一步了解OP生态和运作原理   
3. 你认为你会完成本次残酷学习吗？
会的

## Notes

<!-- Content_START -->

### 2025.01.06
Optimistic Rollup是一种依赖于 Layer 1（L1）区块链的 Layer 2（L2）扩展解决方案。它通过利用 L1 区块链（如以太坊）的共识机制（PoW 或 PoS），而非自建共识机制，来保证安全性。
在 Optimism 主网上，L1 区块链为以太坊，L2 继承了其安全性和数据可用性保障。
在 Bedrock 体系中，L2 区块通过非合约地址（如 0xff00...0010）保存至以太坊主网，使用 EIP-4844 提议的 blob 数据结构以降低 L1 交易费用。
L1 区块不可篡改或审查，确保了数据完整性和可用性。
为了节省成本，提交至 L1 的区块以压缩格式存储。
Optimism 支持在 L2（如 OP 主网）与 L1（如以太坊主网）之间传递消息，实现 ETH 和 ERC20 代币的跨层转移。
L1 → L2：存款
使用 L1CrossDomainMessenger 或 L1StandardBridge。
存款交易会在对应“epoch”的第一个 L2 区块中被记录。
L2 → L1：提款
初始化提款交易（L2）。
等待输出根提交到 L1，并通过 proveWithdrawalTransaction 提交提款证明。
等待挑战期（主网通常为 7 天）后，完成提款。
状态承诺机制：在 L1 上发布状态承诺，无需直接验证。在挑战窗口（7 天）内，若无人挑战，该承诺即被视为最终确定。
故障证明：如果承诺被挑战，可通过故障证明使其无效，但这不会回滚 OP 主网的交易和状态，仅影响 L1 上的承诺链。
Optimism 的设计通过乐观汇总协议实现了扩展性、安全性和低成本交易。其核心在于将 L2 的计算和存储负载从以太坊主网转移，同时继承以太坊的安全特性，非常适合需要高效扩展的区块链应用场景。
### 2025.01.07
随着去中心化金融（DeFi）和非同质化代币（NFT）生态的迅速发展，区块链的吞吐量和交易成本问题变得日益突出。以太坊作为目前最流行的智能合约平台，面临着每秒处理能力不足（TPS < 20）的瓶颈，导致了网络拥堵和Gas费用的急剧上升。为了克服这些挑战，Layer 2（L2）扩容技术应运而生，并且已经成为以太坊生态系统中最为重要的关注点之一。

一、Layer 2扩容技术简介
Layer 2扩容技术是指建立在主链（Layer 1）之上的二层协议，能够显著提高区块链的吞吐量，同时保持主链的安全性和去中心化特性。主流的Layer 2扩容方案有四种：

Optimistic Rollup
ZK Rollup
Plasma
Validium
二、Layer 2技术的优势
提高吞吐量

在以太坊主链上，由于每秒交易量有限，随着用户的增多，交易拥堵成为普遍问题。Layer 2通过将大部分交易移到二层网络处理，可以大幅提升吞吐量。
降低交易费用

通过将交易批量处理在二层，Layer 2减少了对以太坊主链的依赖，从而降低了交易的Gas费用。
更高的可扩展性

以太坊主链虽然在安全性和去中心化上表现出色，但在扩展性上受限。Layer 2提供了更高的灵活性，支持更多的交易和复杂操作。
激励机制与空投机会

参与Layer 2网络的用户，除了享受更低费用和更高速度外，还可能通过项目方提供的激励措施（如空投）获得额外奖励。
三、主要的Layer 2解决方案
1. Optimistic Rollup
Optimistic Rollup（OR）是目前最为流行的扩容技术之一。它的核心思想是通过“假设”交易是合法的，先将其提交到Layer 2，之后再由验证节点在一定时间内验证其正确性。OR的优势在于简单性，主要的挑战是验证延迟和欺诈证明机制。

优点：相对较为简单，已被多项目采用（如Optimism、Arbitrum）。
缺点：交易延迟较高，存在欺诈证明的时间窗口。
2. ZK Rollup
ZK Rollup（Zero Knowledge Rollup）利用零知识证明的技术，将交易信息压缩成一个有效的证明，提交到以太坊主链。由于交易数据不完全上传主链，ZK Rollup可以极大提高吞吐量和降低费用。

优点：极高的可扩展性和交易速度，具有更低的Gas费用。
缺点：实现技术复杂，且在现阶段，开发工具和生态支持还不完善。
根据计算，ZK Rollup的优势体现在：

ETH转账：ZK Rollup的可扩展性提升了100倍。
ERC-20代币和DeFi交易：对于像Uniswap这类需要处理复杂合约交易的应用，ZK Rollup的拓展性能提高超过400倍。
3. Plasma
Plasma是一种较早期的Layer 2扩容解决方案，它通过将交易移到子链进行处理，从而减轻主链的负担。Plasma的工作原理是使用更小的子链作为扩展，最终通过周期性的汇总数据回到以太坊主链。

优点：易于实现，支持大规模的资产转移。
缺点：子链的安全性问题较为突出，用户需要定期进行退出操作。
4. Validium
Validium与ZK Rollup类似，但它将数据存储在外部链上，而不是以太坊主链。这使得Validium可以处理大量数据和交易，但其牺牲了部分安全性。

优点：更高的吞吐量，适合处理大量数据和交易。
缺点：安全性较弱，依赖于外部的数据存储链。
四、交易费用与扩展性对比
以太坊的Gas费用和网络吞吐量是Layer 2扩容技术设计的核心驱动力。在现有的以太坊网络中，由于Gas费用的波动，交易成本时常过高，影响了用户的体验和应用的可用性。

ZK Rollup的交易费用相对较低，且能够支持更高的TPS（每秒交易数）。以ZK Rollup为例，在理想状态下，每个批次的交易可以达到11,818 TPS，而传统的以太坊主链最多只能处理101 TPS。
Optimistic Rollup的交易吞吐量和费用略逊色于ZK Rollup，但在实现复杂度上较为简单，且生态逐步扩展。
Plasma和Validium则分别适用于不同类型的应用，虽然交易费用较低，但存在安全性问题。
五、未来展望：EIP-4488与EIP-4844
以太坊网络正在不断进行升级，EIP-4488和EIP-4844等提案旨在通过优化Gas费用和网络负载，进一步提升Rollup的成本效益。

EIP-4488：通过限制数据存储量，减少Gas费用，改善Layer 2的性能。
EIP-4844：专门为Rollup设计的一种数据传输格式，能够显著降低Rollup的操作成本。
六、总结
以太坊Layer 2扩容技术是解决当前以太坊网络交易费用过高和吞吐量不足的关键手段。通过采用Optimistic Rollup、ZK Rollup等方案，Layer 2能够在保证以太坊网络安全性和去中心化的前提下，显著提升交易效率和降低成本。未来随着更多EIP提案的实施，Layer 2将继续发挥重要作用，为更多用户和应用提供支持。

### 2025.01.08
1. zkSync 2.0 交易费用分析
(1) 普通交易费用
在 zkSync 2.0 中，交易费用的构成可以分为链上费用和链下费用。例如：
普通交易总成本：
链上费用：0.002 u
链下费用：0.068 u
总费用：0.07 u
交易接收者为新地址的总成本：
链上费用：0.005 u
链下费用：0.20865 u
总费用：0.21365 u
Swap 总成本：
链上费用：0.005 u
链下费用：0.1667 u
总费用：0.1672 u
(2) 影响交易地板价的因素
zkSync 的交易地板价与 ETH 主网 calldata 的费用 密切相关。未来的 EIP4488 计划将大大降低 calldata 的费用，尤其是非零字节数据的费用从 16 gas 降至 3 gas。这一变动预计会大大减少 zkSync 等 Rollup 类型的 L2 解决方案的交易费用。
(3) 费用支付方式
在 zkSync 中，支持 "无气体交易"，即用户在进行交易时，可以使用交易中涉及的代币（如 DAI）支付交易费用，而无需持有 ETH 或其他代币。这种机制简化了用户体验，使得代币持有者可以直接通过所持有的资产完成交易，而不需要额外的资金准备。
(4) zkPorter 交易费用
zkPorter 是 zkSync 2.0 中的一个新功能，旨在降低交易费用。zkPorter 将一部分数据存储从链上转移至链下，因此无需依赖链上数据可用性，从而显著降低交易成本。据官方文档预测，zkPorter 的交易费用可低至 1 到 3 美分。
zkPorter 的关键特点在于：
支持与 ZK Rollup 无缝互操作。
zkPorter 账户 的费用显著低于 Rollup 账户，具体来说，用户在 zkPorter 上进行交易的费用可低于 0.03 美元。
zkPorter 的数据可用性由 zkSync 代币持有者（监护人）保证，采用 PoS 机制进行权益证明，从而保障其数据安全。
2. Arbitrum Gas 机制
Arbitrum 是另一种流行的 L2 解决方案，利用 Optimistic Rollup 技术。Arbitrum 的交易费用受多种因素影响，包括：
L2 执行费：每个 Arbitrum 交易都需要为其计算和存储付费。费用的计算方式与以太坊类似，按交易使用的 gas 数量和附带的 gas 价格来计算。
费用结构：
交易费用的计算公式为：
makefile
复制代码
l2_execution_fee = transaction_gas_price * l2_gas_used
在 Arbitrum 中，L1 数据费用是一个额外的成本来源。这是由于 Arbitrum 上的所有交易需要在以太坊主网提交数据以确保其安全性。
3. Optimism Gas 机制
与 Arbitrum 类似，Optimism 也采用了 Optimistic Rollup 技术，因此其交易费用包含以下两部分：
(1) L2 执行费
与以太坊类似，Optimism 上的交易同样需要为计算和存储付费。每笔交易的费用由交易的 gas 数量与附带的 gas 价格相乘得到。
(2) L1 数据费用
Optimism 的交易不仅在其 L2 网络上执行，还需要将相关数据发布到以太坊主网。这一过程涉及到 L1 数据费用，是 Optimism 特有的成本项，主要由以下几个因素决定：
以太坊当前的 gas 价格；
将交易数据发布到以太坊的 gas 成本；
交易的字节大小（与交易数据的长度成正比）；
固定的 2100 gas 固定费用；
动态的间接费用。
由于以太坊的 gas 成本较高，L1 数据费用通常会占据 Optimism 交易总费用的较大部分。
### 2025.01.09
在区块链技术的发展过程中，Rollup（滚动聚合）已经成为一种备受关注的扩容方案，尤其是在以太坊网络中。Rollup 通过将交易数据压缩并在Layer 1（L1）上发布，以实现更高效的交易处理，同时保持一定的安全性。然而，Rollup 系统的开发通常需要经过一个由中心化控制主导的阶段，这一阶段被称为“训练轮”阶段。这个阶段允许开发者在一个受控的环境中进行系统更新和漏洞修复。

随着技术的发展，Rollup 需要逐渐去除这些“训练轮”，以充分继承基础层（L1）的安全性。为了指导这一过渡过程，Vitalik Buterin 提出了一个逐步过渡的框架，并根据不同的去中心化程度，将 Rollup 分为三个阶段。

Rollup 三个发展阶段
Stage 0 — 完全训练轮： 在这个阶段，Rollup 系统仍然由少数运营者控制。虽然存在源代码可用的软件，可以通过在 L1 上发布的数据来重建系统状态，但 Rollup 本身并没有完全去中心化。该阶段的关键特征是，Rollup 的操作和管理完全依赖于运营者的控制。

Stage 1 — 有限训练轮： 随着 Rollup 逐渐过渡到由智能合约管理，**Security Council（安全委员会）**可能依然存在，负责解决潜在的错误或漏洞。这个阶段的特点是，Rollup 开始实现完全的欺诈证明系统（fraud proofs）和去中心化的欺诈证明提交机制。此外，用户也可以在没有运营者协调的情况下退出系统。尽管 Security Council 在此阶段提供了安全保障，但其权力可能带来一定的风险，尤其是当治理不透明时。

Stage 2 — 无训练轮： 这是最终阶段，Rollup 完全由智能合约管理。在这个阶段，欺诈证明系统是无许可的，用户可以在不受治理攻击威胁的情况下退出系统。Security Council 的作用仅限于处理链上能够裁定的正确性错误，不再干预 Rollup 的日常运行。此时，Rollup 达到完全的去中心化，能够独立运行并受到以太坊主链的保护。

背景与动机
这一框架的提出源于Vitalik Buterin在2022年11月对以太坊 Rollup 发展路径的初步构想。他认为，Rollup 系统的去中心化过程并不是一蹴而就的，而是一个逐步过渡的过程。然而，随着讨论的深入，大家逐渐意识到，一个简单的评级系统无法充分表达每个 Rollup 系统的复杂性和细节。不同的项目可能采取不同的路线实现去中心化，因此需要一个更精确的框架来评估 Rollup 的成熟度。

框架设计与更新
为了有效评估不同 Rollup 的发展阶段，我们对原有的评级系统进行了更新。通过结合 Vitalik 提出的三个阶段框架，并明确了一些关键参数（如最小退出窗口、Security Council 阈值和欺诈证明白名单大小），我们力求提供一个既简单易懂，又具备足够细节的评估系统。

这个框架不仅为公众提供了清晰的理解，还为开发者和社区提供了更加准确的标准，帮助他们评估一个 Rollup 是否已达到去中心化的要求。虽然这一框架目前还在不断演进，我们相信它将成为未来深入讨论的基础。
### 2025.01.10
### 2025.01.11
### 2025.01.12
在区块链技术不断发展的过程中，Rollup 作为一种可信最小化的扩展解决方案，已成为以太坊扩容的重要方法。然而，在这些系统的发展早期阶段，通常需要一种被称为“训练轮”（training wheels）的集中式控制机制，用于系统更新和漏洞修复。在 Rollup 的成熟过程中，移除这些“训练轮”是必要的，以便它们能够完全继承底层以太坊的安全性。

以下是一种基于 Vitalik 提出的里程碑概念的新框架，旨在对 Rollup 的成熟度进行分类。此框架将 Rollup 分为三个阶段：

第一阶段：完全训练轮（Stage 0 — Full Training Wheels）
核心特点：
Rollup 的运行主要由运营方控制。
提供源代码开放的软件，可以从发布在 L1 上的数据中重建状态。
用于验证状态根是否与提议的状态根一致。
第二阶段：有限训练轮（Stage 1 — Limited Training Wheels）
过渡性特征：
Rollup 的管理转移至智能合约，但仍设有安全委员会（Security Council）。
技术改进：
全功能证明系统上线。
验证欺诈证明的流程去中心化。
用户可以在无需运营方协调的情况下退出系统。
安全委员会的角色：
提供应急支持，修复潜在漏洞。
存在一定的风险，因为安全委员会仍然拥有权力。
第三阶段：完全去中心化（Stage 2 — No Training Wheels）
最终目标：
Rollup 的管理完全由智能合约负责。
验证欺诈证明的过程完全无权限化（permissionless）。
用户保护：
用户可在面临不受欢迎的升级时拥有充足的退出时间。
安全委员会的作用：
仅限于解决可以链上裁决的安全性问题。
防范治理攻击，保护用户资产。
#<!-- Content_END -->

