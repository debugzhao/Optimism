# {stualan}

1. 一个web3技术学习者
2. 你认为你会完成本次残酷学习吗？会，学习op中的设计思想和一些治理相关的内容

## Notes

<!-- Content_START -->

### 2025.01.06

- 阅读[OP Rollup设计](https://docs.optimism.io/stack/rollup/overview)理念文档
---

## **Optimism Rollup 概述**

Optimism Rollup 是一种 Layer 2 扩展解决方案，旨在提高以太坊的可扩展性，同时保持与以太坊主网的高度安全性和兼容性。它通过将交易批量处理并压缩后提交到以太坊主网，显著降低了交易成本并提高了吞吐量。

---

### **核心概念**

1. **Rollup 技术**  
   - Rollup 是一种 Layer 2 扩展技术，将大量交易数据压缩后提交到以太坊主网。
   - 交易执行在链下进行，但数据存储在链上，确保安全性和透明性。
   - Optimism 使用 **Optimistic Rollup**，默认假设所有交易有效，除非有人提交欺诈证明。

2. **Optimistic Rollup 的特点**  
   - **低成本**：通过批量处理交易，减少以太坊主网的 Gas 费用。
   - **高吞吐量**：链下执行交易，显著提高交易处理速度。
   - **安全性**：依赖以太坊主网的安全性，通过欺诈证明机制确保交易有效性。

3. **欺诈证明（Fraud Proof）**  
   - 如果有人提交无效交易，其他节点可以生成欺诈证明，挑战该交易。
   - 挑战成功后，无效交易会被回滚，恶意行为者会受到惩罚。

4. **EVM 等效性**  
   - Optimism Rollup 完全兼容以太坊虚拟机（EVM），开发者可以无缝迁移以太坊 DApp。
   - 支持所有以太坊工具和基础设施（如 MetaMask、Truffle 等）。

---

### **Optimism Rollup 的架构**

1. **Sequencer（排序器）**  
   - 负责接收用户交易，排序并批量提交到以太坊主网。
   - 提供即时交易确认，优化用户体验。

2. **Verifier（验证者）**  
   - 验证链下交易的有效性，确保与以太坊主网状态一致。
   - 在发现无效交易时生成欺诈证明。

3. **数据可用性**  
   - 所有交易数据都存储在以太坊主网上，确保透明性和可验证性。
   - 即使 Layer 2 节点离线，用户也可以从主网恢复数据。

4. **跨链通信**  
   - 通过 **L1 和 L2 之间的消息传递**，实现资产和数据的跨链转移。
   - 用户可以将资产从以太坊主网存入 Optimism Rollup，或从 Rollup 提现到主网。


### **Optimism Rollup 的优势**

1. **低成本**  
   - 通过批量处理和压缩交易，显著降低 Gas 费用。
   - 适合高频交易和小额支付场景。

2. **高兼容性**  
   - 完全兼容以太坊 EVM，开发者无需修改代码即可迁移 DApp。
   - 支持现有以太坊工具和基础设施。

3. **安全性**  
   - 依赖以太坊主网的安全性，通过欺诈证明机制确保交易有效性。
   - 数据存储在链上，确保透明性和可验证性。

4. **用户体验**  
   - 提供即时交易确认，减少用户等待时间。
   - 支持跨链资产转移，方便用户操作。
---

### **Optimism Rollup 的挑战**

1. **挑战期延迟**  
   - 提现到以太坊主网需要等待挑战期结束（通常 7 天）。
   - 可能影响用户体验。

2. **中心化风险**  
   - Sequencer 目前由 Optimism 团队运营，存在一定的中心化风险。
   - 未来计划引入去中心化 Sequencer。

3. **欺诈证明复杂性**  
   - 欺诈证明机制需要复杂的实现和验证。
   - 可能增加开发和维护成本。

### 2025.01.07
---
### **Optimism Rollup 的工作流程**

1. **交易提交**  
   - 用户将交易发送到 Optimism Rollup 的 Sequencer。
   - Sequencer 对交易进行排序并生成批次。

2. **批次提交**  
   - Sequencer 将交易批次压缩后提交到以太坊主网。
   - 主网存储交易数据，确保数据可用性。

3. **状态更新**  
   - 交易在链下执行，生成新的状态根。
   - 状态根提交到以太坊主网，更新 Layer 2 状态。

4. **欺诈证明挑战期**  
   - 提交的状态根进入挑战期（通常为 7 天）。
   - 在此期间，任何人都可以提交欺诈证明，挑战无效交易。

5. **最终确认**  
   - 如果挑战期内无人挑战，状态根被最终确认。
   - 如果有挑战，以太坊主网会仲裁并决定是否回滚交易。
---

### 2025.01.08
Layer-2 扩容方案旨在解决以太坊主网的拥堵和高 Gas 费问题。目前主要有四种 Layer-2 解决方案，它们在交易成本、安全性、速度等方面各有优劣。以下分别介绍这四种方案的交易成本：

**1. Optimistic Rollup **

*   **工作原理：** 乐观 Rollup 将大量交易在链下打包和执行，然后将交易数据（calldata）和状态根发布到以太坊主链。它“乐观地”假设交易是有效的，并通过欺诈证明机制来处理无效交易。
*   **交易成本：**
    *   **L2 Gas 费（链下）：** 非常低，因为交易主要在链下执行。
    *   **L1 Gas 费（链上）：** 主要成本是 calldata 的 Gas 费，用于将压缩后的交易数据发布到以太坊主链。因此，L1 Gas 费受以太坊主链 Gas Price 的影响较大。
    *   **总 Gas 费：** `总 Gas 费 = L2 Gas 费 + L1 Gas 费`。总费用通常比以太坊主网低很多，但仍然会受到以太坊主网 Gas Price 的波动影响。
*   **影响 L1 Gas 费的因素：**
    *   **Calldata 大小：** 交易数据越多，calldata 越大，L1 Gas 费越高。
    *   **以太坊主链 Gas Price：** 主网 Gas Price 越高，L1 Gas 费越高。
    *   **批量处理效率：** 将更多 L2 交易打包成一个 L1 交易可以分摊 L1 Gas 费。
*   **代表项目：** Arbitrum、Optimism。

**2. ZK Rollup（零知识Rollup）**

*   **工作原理：** ZK Rollup 在链下执行交易，并生成一个简洁的零知识证明（zk-SNARK 或 zk-STARK），证明这些交易的有效性。这个证明会被发布到以太坊主链，验证者无需重新执行所有交易即可验证其有效性。
*   **交易成本：**
    *   **L2 Gas 费（链下）：** 也很低。
    *   **L1 Gas 费（链上）：** 主要成本是发布零知识证明的 Gas 费。虽然证明本身比 calldata 小得多，但生成证明的计算成本较高。
    *   **总 Gas 费：** 通常比 Optimistic Rollup 更低，尤其是在交易量较大时。
*   **优势：** 安全性更高，因为不需要等待期和欺诈证明。
*   **劣势：** 开发难度较高，通用性不如 Optimistic Rollup。
*   **代表项目：** zkSync、StarkNet。

**3. Validium**

*   **工作原理：** Validium 与 ZK Rollup 类似，也使用零知识证明来验证链下交易的有效性。但不同之处在于，Validium 将交易数据存储在链下，而不是像 ZK Rollup 那样存储在链上。
*   **交易成本：**
    *   **L2 Gas 费（链下）：** 非常低。
    *   **L1 Gas 费（链上）：** 极低，因为只需在链上发布证明，而无需发布交易数据。
*   **优势：** 交易成本最低。
*   **劣势：** 数据可用性存在一定风险，因为数据存储在链下，如果数据提供者出现问题，可能会导致用户无法访问自己的资产。
*   **适用场景：** 适合对安全性要求不高，但对成本非常敏感的应用，例如游戏、支付等。
*   **代表项目：** StarkEx。

**4. Plasma**

*   **工作原理：** Plasma 使用一种“子链”结构，将交易放在独立的子链上执行，并通过默克尔树将子链的状态根锚定到以太坊主链。
*   **交易成本：**
    *   **L2 Gas 费（链下）：** 较低。
    *   **L1 Gas 费（链上）：** 用于将子链的状态根提交到主链，成本相对较低。
*   **劣势：** 提款需要较长的等待期（挑战期），并且在某些情况下可能需要用户进行数据可用性证明，这会增加复杂性。
*   **应用受限：** 由于其固有的局限性，Plasma 的应用范围相对有限，主要用于简单的支付和代币转移。
*   **目前使用较少**

**四种方案的交易成本对比（大致排序，具体数值会根据网络状况变化）：**

Validium < ZK Rollup < Optimistic Rollup < 以太坊主网

### 2025.01.09
通过阅读 [资料](https://medium.com/l2beat/introducing-stages-a-framework-to-evaluate-rollups-maturity-d290bb22befe) 构想经过三个阶段
- Stage 0 — Full Training Wheels: At this stage, the rollup is effectively run by the operators. Still, there is an source-available software that allows for the reconstruction of the state from the data posted on L1, used to compare state roots with the proposed ones.
- Stage 1 — Limited Training Wheels: In this stage, the rollup transitions to being governed by smart contracts. However, a Security Council might remain in place to address potential bugs. This stage is characterized by the implementation of a fully functional proof system, decentralization of fraud proof submission, and provision for user exits without operator coordination. The Security Council, comprised of a diverse set of participants, provides a safety net, but its power also poses a potential risk.
- Stage 2 — No Training Wheels: This is the final stage where the rollup becomes fully managed by smart contracts. At this point, the fraud proof system is permissionless, and users are given ample time to exit in the event of unwanted upgrades. The Security Council’s role is strictly confined to addressing soundness errors that can be adjudicated on-chain, and users are protected from governance attacks.
### 2025.01.10
- 学习OP的代币智力体系
- optimism collective的治理由token house和citizen house组成，两者相互制衡
### 2025.01.11
- 周六请假
### 2025.01.12
- 周日请假
### 2025.01.13
- 代币议院（Token House）
- 成员构成：OP 代币持有者或其委托的代表，通过代币投票权参与治理。

- 核心职责：

- 协议升级（如智能合约修改、通胀率调整）；

- 治理基金分配（支持生态发展项目）；

- 罢免基金会董事或否决核心文件变更。

- 投票机制：代币投票需满足法定人数（如30%总可投票供应量）和特定通过门槛（例如协议升级需76%支持率）
### 2025.01.14
- 公民议院（Citizen's House）
- 成员构成：通过参与 RetroPGF（追溯公共物品资助）获得临时公民身份的社区成员，采用“一人一票”制。
- 核心职责：
- 分配 RetroPGF 资金，奖励对生态有贡献的公共物品项目；
- 对代币议院通过的协议升级或通胀调整提案行使否决权（需30%公民投票反对）
### 2025.01.15
- 代币功能

1. 治理权：OP 持有者可投票决定协议发展方向，包括资金分配、技术升级等；

2. 经济激励：通过 RetroPGF 和空投奖励生态贡献者，形成“影响=利润”的飞轮效应；

3. 治理基金：初始代币供应的25%用于生态激励，支持开发者与社区项目
### 2025.01.16
- 代币分配

1. 初始供应：42.9亿枚 OP，年通胀率2%2；

2. 分配比例：

- 生态系统基金（25%）、追溯公共物品资金（20%）、用户空投（19%）、核心贡献者（19%）、投资者（17%）213；

- 空投策略：通过多轮空投奖励早期用户、DAO参与者和跨链用户，例如2024年第五季向5.4万个地址分发1000万枚 OP
### 2025.01.17

####  治理流程与决策机制
1. **提案周期**  
   - **三周制**：每项提案需经历草案讨论（两周）和投票期（一周），投票期需满足法定人数与通过阈值；
   - **特殊提案**：紧急维护类提案可采用“乐观投票”机制，缩短决策时间。

2. **提案类型与要求**  
   | 提案类型               | 发起方       | 通过条件                     | 否决权归属       |
   |------------------------|--------------|------------------------------|------------------|
   | 协议升级               | 代币议院     | 76%支持率 + 30%法定人数      | 公民议院 |
   | RetroPGF资金分配       | 公民议院     | 简单加权投票制               | 无               |
   | 治理基金使用           | 代币议院     | 51%支持率 + 30%法定人数      | 无   |

3. **去中心化工具**  
   - **Optimism治理门户**：提供链上投票与委托功能；
   - **Snapshot空间**：公民议院投票平台；
   - **论坛与Discord**：社区讨论与提案反馈。


### 2025.01.18
- 周六请假
# 2025.01.19
- 周日请假

# 2025.1.20

- 本周学习[RetroPFG](https://community.optimism.io/citizens-house/how-retro-funding-works)机制

### **RetroPGF 的核心机制与目标**
**1. 定义与原则**  
RetroPGF（Retroactive Public Goods Funding）是 Optimism 生态系统中的一种资金分配机制，旨在通过 **事后奖励** 的方式，对已证明对 Optimism 或以太坊生态系统产生积极影响的公共物品项目进行资助。其核心理念是 **“影响力=利润”**，即贡献者的社会价值应转化为经济收益，从而激励更多人参与公共物品建设。

**2. 目标**  
- **填补市场失灵**：传统公共物品（如开源工具、教育内容）因缺乏盈利模式常被资本忽视，RetroPGF 提供可持续的退出机制，吸引私有资本投入。  
- **促进生态增长**：通过资助基础设施、工具和教育项目，降低用户参与 Optimism 生态的门槛，形成“公共物品→生态繁荣→更多资助”的飞轮效应。  

# 2025.1.21

### **治理架构与流程**
**1. 两院制治理结构**  
Optimism 的治理由 **代币议院（Token House）** 和 **公民议院（Citizen House）** 共同主导，形成资本与价值观的平衡：  
- **代币议院**：由 OP 代币持有者组成，负责批准资金池（如 RetroPGF 3 分配了 3000 万 OP）及协议升级，投票权重与代币持有量挂钩。  
- **公民议院**：由社区推荐的“公民”组成（如 RetroPGF 3 有 146 位公民），采用“一人一票”原则，负责具体资金分配，避免财阀统治。  

**2. 资助流程**  
1. **提名与申请**：任何人均可提名符合资助范围的项目（如工具开发、内容创作），需在治理论坛提交申请并说明影响力。  
2. **审核与投票**：公民通过工具（如 OpenSource Observer）评估项目数据，并借助 Pairwise 等工具进行对比投票。投票结果需结合定量指标（如链上数据）与定性判断（如社区价值）。  
3. **资金发放**：通过 KYC 验证的项目将直接获得 OP 代币奖励。例如，RetroPGF 3 在 2024 年 1 月完成 3000 万 OP 的分配。  


# 2025.1.22

### **资金模型与分配演变**
**1. 资金来源**  
- **初始代币分配**：Optimism 初始代币的 20% 专用于 RetroPGF。  
- **协议收入**：Superchain 成员需将 15% 的排序器收入或利润上交，作为长期资金池。  
- **通胀机制**：OP 代币年通胀率 2%，部分用于补充资金。  

**2. 资助方向迭代**  
- **早期阶段**：聚焦纯公共物品（如 ZachXBT 的反欺诈贡献），强调社会影响力而非直接增长。  
- **后期阶段（如 RetroPGF 7）**：引入 **任务导向型资助**（Missions），结合数据算法与人工评估，重点支持：  
  - **链上建设者（Onchain Builders）**：激励跨链互操作性项目，评估标准包括 Superchain 采用率、TVL 增长等。  
  - **开发工具（Dev Tooling）**：资助提升 OP Stack 效率的工具（如编译器、调试器），需避免与早期资助重复。  

# 2025.1.23

### **OP Stack 的定义与定位**
OP Stack 是 **Optimism Collective** 推出的标准化、开源模块化开发框架，旨在简化以太坊 Layer 2（L2）及 Layer 3（L3）区块链的构建，并推动形成互联互通的 **超级链（Superchain）** 网络。其核心目标是通过模块化设计，解决区块链扩展性、互操作性和碎片化问题。

- **模块化架构**：OP Stack 将区块链的不同功能层（执行层、数据可用性层、结算层等）解耦为独立模块，开发者可自由组合或替换模块（如切换数据可用性方案或虚拟机），满足特定需求。
- **标准化与开源**：所有模块遵循统一标准且完全开源，支持开发者协作迭代，避免重复造轮子。


# 2025.1.24

### **核心组件与技术特性**
#### **关键组件** 
1. **执行层**：默认基于以太坊虚拟机（EVM），支持替换为其他虚拟机（如 FuelVM）。
2. **数据可用性层**：可选择以太坊、Celestia 或其他 DA 方案，降低成本。
3. **结算层**：依赖以太坊主网确保最终性，未来可能支持多结算层。
4. **治理与工具**：包括区块浏览器、跨链通信协议等。

#### **技术亮点**
- **Bedrock 升级**：优化了交易批处理效率，引入 **SystemConfig 合约**，允许通过 L1 智能合约定义 L2 链的配置（如 Gas 限制、排序器地址），实现链的标准化部署。
- **确定性地址生成**：通过 CREATE2 生成与链配置对应的合约地址，简化跨链交互。
- **模块化排序器**：支持自定义排序模型（如轮询、竞价排序），推动去中心化。
- **Plasma 模式与自定义 Gas 代币**：允许开发者选择 DA 层并自定义 Gas 代币，降低用户成本。

# 2025.1.25
Bedrock 是 Optimism OP Stack 的一次重大架构升级，旨在提高性能、降低成本和增强安全性。它通过以下几个主要方式降低了交易成本：

1.  **更高效的数据压缩：** 这是 Bedrock 降低成本的最主要因素。Rollup 的主要成本是将交易数据（calldata）发布到以太坊主链。Bedrock 采用了更先进的数据压缩技术，减少了需要发布到 L1 的数据量，从而直接降低了 calldata 的 Gas 费用。

    *   **差异编码（Delta encoding）：** Bedrock 使用差异编码来压缩状态更新。它只发布状态变化的差异部分，而不是完整的状态数据，从而大幅减少了数据量。
    *   **更有效的数据格式：** Bedrock 使用了更紧凑的数据格式，进一步减少了数据大小。

2.  **优化的执行层：** Bedrock 对执行层进行了优化，提高了交易处理效率，减少了 L2 上的 Gas 消耗。虽然 L2 Gas 费在总成本中占比相对较小，但优化执行层仍然有助于降低总体成本。

3.  **降低 L1 开销：** 除了压缩 calldata，Bedrock 还通过其他方式减少了 L1 上的开销：

    *   **更少的 L1 操作：** Bedrock 减少了在 L1 上执行的操作数量，例如提交状态根的频率等，从而降低了 L1 Gas 费用。
    * **规范化的执行客户端**: Bedrock 升级后，OP Rollup 的执行客户端与以太坊的执行客户端更加接近。这使得可以复用以太坊客户端的各种优化，从而降低成本。

4. **共享排序器 (未来展望):** 虽然目前 Bedrock 还没有完全实现共享排序器，但这是 OP Stack 的长期目标。通过共享排序器，多个 OP Chain 可以共享同一个排序器来处理交易，从而大幅降低排序成本，并提高效率和增强安全性。

**总结来说，Bedrock 主要通过以下方式降低交易成本：**

*   **大幅减少需要发布到 L1 的数据量（通过更高效的数据压缩）。**
*   **优化 L2 执行层，减少 L2 Gas 消耗。**
*   **减少 L1 上的操作数量。**
* **未来通过共享排序器进一步降低成本。**

通过这些改进，Bedrock 显著降低了 Optimism 用户的交易成本，使其更具竞争力。根据一些测试和实际数据，Bedrock 可以将交易 Gas 费降低 40% 甚至更多。这使得 Optimism 成为进行小额交易和频繁交互的更经济的选择。



# 2025.1.26

- OP Stack 的设计目标之一就是提高用户体验，简化用户与 Layer-2 的交互。

*   **EVM 等效性：** OP Stack 旨在尽可能地与以太坊虚拟机（EVM）兼容。这意味着以太坊上的智能合约和工具可以相对容易地迁移到 OP Chain 上，用户可以使用熟悉的钱包和工具进行交互。这大大降低了用户的使用门槛。
*   **低交易成本：** 如前所述，Bedrock 升级显著降低了交易成本，使得在 OP Chain 上进行交易更加经济实惠，从而提升了用户体验。
*   **快速交易确认：** OP Chain 的区块生成速度比以太坊主网更快，交易确认时间更短，用户可以更快地完成交易。
*   **桥接和跨链互操作性：** OP Stack 致力于实现不同 OP Chain 之间的无缝互操作。通过标准化的消息传递格式和桥接机制，用户可以方便地在不同的 OP Chain 之间转移资产和数据，从而提高了用户体验和生态系统的流动性。
*   **易于使用的工具和基础设施：** OP Stack 的目标是提供易于使用的开发工具和基础设施，例如钱包、区块浏览器、开发框架等，从而方便用户和开发者使用 OP Chain。
* **抽象证明层**: OP Stack 在将资金结算到另一条链时，对证明层进行了抽象。只要证明层满足证明 API，就可以被插入到系统中，而不会对用户体验产生任何影响。这使得 Optimism 有可能适应更新的证明系统。


<!-- Content_END -->
